The cryptographic strength of iMessage relies in part on a number of security
features present in every iOS device. Cryptographic algorithms are often
complex and can present significant performance and battery life implications.
These priorities drive the architecture of iOS device security to help make
implementations of cryptographic algorithms fast and safe.

\subsection{AES Coprocessor}
% AES 256 engine, SHA-1 in hardware
At the core of Apple's security architecture is a hardware decive referred to
as the Crypto Engine or the AES Coprocessor. During the manufacturing process,
two 256-bit AES Keys are burned into the coprocessor. The first is the unique
ID (UID), which, as its name implies, is unique to every iOS device. Apple
states that the UID is not recorded by Apple or any of its
suppliers\cite{apple}. The second key is a device group ID (GID), which is
shared by all iOS devices of the same class (all devices with an Apply A7
processor share the same GID, for example). Burning these keys into the silicon
itself helps the keys from being accessed from outside of the Crypto Engine.
% UID, GID
% Derived keys

\subsection{Random Number Generation}
% CTR_DRBG
% System entropy from hardware
Pseudorandom number generation plays an important role in many cryptographic
operations, such as saltas generated for use in ECDSA. iOS devices use have
random number generator (RNG) that uses an algorithm based on Counter mode
Deterministic Random Byte Generator (CTR\_DRBG).  CTR\_DRBG is one of four
cryptographically secure pseudorandom number generators published by the
National Institute of Standards and Technology in NIST SP
800-90A\cite{nistsp80090a}.

CSPRNGs generally fall into three classes: those based on cryptographic
primitives (ciphers and hashes), those of number theoretic designs (like Blum
Blum Shub), and those of special-purpose designs. Of the four CSPRNGs of NIST
SP 800-90A, three are of the type based on cryptographic primitives: Hash\_DRBG
(based on hash functions), HMAC\_DRBG (based on hash-based message
authentication code), and CTR\_DRBG (based on block ciphers). The fourth CSPRNG
in 800-90A is Dual\_EC\_DRBG, is of the number theoretic class is based on
elliptic curve cryptography. It was later reported to likely contain a backdoor
inserted by the National Security Agency\cite{goodin}. The other RNGs,
including CTR\_DRBG, however, are still considered to be secure.

\subsection{Effaceable Storage}
% Sucurity implications of flash storage
